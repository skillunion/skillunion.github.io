<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js"><span id='Ext-chart-theme-Base'>/**
</span> * Abstract class that provides default styles for non-specified things.
 * Should be sub-classed when creating new themes.
 * For example:
 *
 *     Ext.define(&#39;Ext.chart.theme.Custom&#39;, {
 *         extend: &#39;Ext.chart.theme.Base&#39;,
 *         singleton: true,
 *         alias: &#39;chart.theme.custom&#39;,
 *         config: {
 *             baseColor: &#39;#ff9f00&#39;
 *         }
 *     });
 *
 * Theme provided values will not override the values provided in an instance config.
 * However, if a theme provided value is an object, it will be merged with the value
 * from the instance config, unless the theme provided object has a &#39;$default&#39; key
 * set to &#39;true&#39;.
 *
 * Certain chart theme configs (e.g. &#39;fontSize&#39;) may use the &#39;default&#39; value to indicate
 * that they should inherit a value from the corresponding CSS style provided by
 * a framework theme. Additionally, one can use basic binary operators like multiplication,
 * addition and subtraction to derive from the default value, e.g. fontSize: &#39;default*1.3&#39;.
 *
 * Important: the theme should not use the &#39;font&#39; shorthand to specify the font of labels
 * and other text elements of a chart. Instead, individual font properties should be used:
 * &#39;fontStyle&#39;, &#39;fontVariant&#39;, &#39;fontWeight&#39;, &#39;fontSize&#39; and &#39;fontFamily&#39;.
 */
Ext.define(&#39;Ext.chart.theme.Base&#39;, {
    extend: &#39;Ext.chart.theme.BaseTheme&#39;,

    mixins: {
        factoryable: &#39;Ext.mixin.Factoryable&#39;
    },

    requires: [&#39;Ext.draw.Color&#39;],

<span id='Ext-chart-theme-Base-property-factoryConfig'>    factoryConfig: {
</span>        type: &#39;chart.theme&#39;
    },

<span id='Ext-chart-theme-Base-property-isTheme'>    isTheme: true,
</span><span id='Ext-chart-theme-Base-property-isBase'>    isBase: true,
</span>
    config: {
<span id='Ext-chart-theme-Base-cfg-baseColor'>        /**
</span>         * @cfg {String/Ext.util.Color} baseColor
         * The base color used to generate the {@link Ext.chart.AbstractChart#colors} of the theme.
         */
        baseColor: null,

<span id='Ext-chart-theme-Base-cfg-colors'>        /**
</span>         * @cfg {Array} colors
         *
         * Array of colors/gradients to be used by the theme.
         * Defaults to {@link #colorDefaults}.
         */
        colors: undefined,

<span id='Ext-chart-theme-Base-cfg-gradients'>        /**
</span>         * @cfg {Object} gradients
         *
         * The gradient config to be used by series&#39; sprites. E.g.:
         *
         *     {
         *       type: &#39;linear&#39;,
         *       degrees: 90
         *     }
         *
         * Please refer to the documentation for the {@link Ext.draw.gradient.Linear linear}
         * and {@link Ext.draw.gradient.Radial radial} gradients for all possible options.
         * The color {@link Ext.draw.gradient.Gradient#stops stops} for the gradients
         * will be generated by the theme based on the {@link #colors} config.
         */
        gradients: null,

<span id='Ext-chart-theme-Base-cfg-chart'>        /**
</span>         * @cfg {Object} chart
         * Theme defaults for the chart.
         * Can apply to all charts or just a specific type of chart.
         * For example:
         *
         *     chart: {
         *       defaults: {
         *         background: &#39;lightgray&#39;
         *       },
         *       polar: {
         *         background: &#39;green&#39;
         *       }
         *     }
         *
         * The values from the chart.defaults and chart.*type* configs (where *type* is a valid
         * chart xtype, e.g. &#39;{@link Ext.chart.CartesianChart cartesian}&#39; or &#39;{@link Ext.chart.PolarChart polar}&#39;)
         * will be applied to corresponding chart configs.
         * E.g., the chart.defaults.background config will set the {@link Ext.chart.AbstractChart#background}
         * config of all charts, where the chart.cartesian.flipXY config will only set the
         * {@link Ext.chart.CartesianChart#flipXY} config of all cartesian charts.
         */
        chart: {
            defaults: {
                captions: {
                    title: {
                        docked: &#39;top&#39;,
                        padding: 5,
                        style: {
                            textAlign: &#39;center&#39;,
                            fontFamily: &#39;default&#39;,
                            fontWeight: &#39;500&#39;,
                            fillStyle: &#39;black&#39;,
                            fontSize: &#39;default*1.6&#39;
                        }
                    },
                    subtitle: {
                        docked: &#39;top&#39;,
                        style: {
                            textAlign: &#39;center&#39;,
                            fontFamily: &#39;default&#39;,
                            fontWeight: &#39;normal&#39;,
                            fillStyle: &#39;black&#39;,
                            fontSize: &#39;default*1.3&#39;
                        }
                    },
                    credits: {
                        docked: &#39;bottom&#39;,
                        padding: 5,
                        style: {
                            textAlign: &#39;left&#39;,
                            fontFamily: &#39;default&#39;,
                            fontWeight: &#39;lighter&#39;,
                            fillStyle: &#39;black&#39;,
                            fontSize: &#39;default&#39;
                        }
                    }
                },
                background: &#39;white&#39;
            }
        },

<span id='Ext-chart-theme-Base-cfg-axis'>        /**
</span>         * @cfg {Object} axis
         * Theme defaults for the axes.
         * Can apply to all axes or only axes with a specific position.
         * For example:
         *
         *     axis: {
         *       defaults: {
         *         style: {strokeStyle: &#39;red&#39;}
         *       },
         *       left: {
         *         title: {fillStyle: &#39;green&#39;}
         *       }
         *     }
         *
         * The values from the axis.defaults and axis.*position* configs (where *position*
         * is a valid axis {@link Ext.chart.axis.Axis#position}, e.g. &#39;bottom&#39;) will be
         * applied to corresponding {@link Ext.chart.axis.Axis axis} configs.
         * E.g., the axis.defaults.label config will apply to the {@link Ext.chart.axis.Axis#label}
         * config of all axes, where the axis.left.titleMargin config will only apply to the
         * {@link Ext.chart.axis.Axis#titleMargin} config of all axes positioned to the left.
         */
        axis: {
            defaults: {
                label: {
                    x: 0,
                    y: 0,
                    textBaseline: &#39;middle&#39;,
                    textAlign: &#39;center&#39;,
                    fontSize: &#39;default&#39;,
                    fontFamily: &#39;default&#39;,
                    fontWeight: &#39;default&#39;,
                    fillStyle: &#39;black&#39;
                },
                title: {
                    fillStyle: &#39;black&#39;,
                    fontSize: &#39;default*1.23&#39;,
                    fontFamily: &#39;default&#39;,
                    fontWeight: &#39;default&#39;
                },
                style: {
                    strokeStyle: &#39;black&#39;
                },
                grid: {
                    strokeStyle: &#39;rgb(221, 221, 221)&#39;
                }
            },
            top: {
                style: {
                    textPadding: 5
                }
            },
            bottom: {
                style: {
                    textPadding: 5
                }
            }
        },

<span id='Ext-chart-theme-Base-cfg-series'>        /**
</span>         * @cfg {Object} series
         * Theme defaults for the series.
         * Can apply to all series or just a specific type of series.
         * For example:
         *
         *     series: {
         *       defaults: {
         *         style: {
         *           lineWidth: 2
         *         }
         *       },
         *       bar: {
         *         animation: {
         *           easing: &#39;bounceOut&#39;,
         *           duration: 1000
         *         }
         *       }
         *     }
         *
         * The values from the series.defaults and series.*type* configs (where *type*
         * is a valid series {@link Ext.chart.series.Series#type}, e.g. &#39;line&#39;) will be
         * applied to corresponding series configs.
         * E.g., the series.defaults.label config will apply to the {@link Ext.chart.series.Series#label}
         * config of all series, where the series.line.step config will only apply to the
         * {@link Ext.chart.series.Line#step} config of {@link Ext.chart.series.Line line} series.
         */
        series: {
            defaults: {
                label: {
                    fillStyle: &#39;black&#39;,
                    strokeStyle: &#39;none&#39;,
                    fontFamily: &#39;default&#39;,
                    fontWeight: &#39;default&#39;,
                    fontSize: &#39;default*1.077&#39;,
                    textBaseline: &#39;middle&#39;,
                    textAlign: &#39;center&#39;
                },
                labelOverflowPadding: 5
            }
        },

<span id='Ext-chart-theme-Base-cfg-sprites'>        /**
</span>         * @cfg {Object} sprites
         * Default style for the custom chart sprites by type.
         * For example:
         *
         *     sprites: {
         *       text: {
         *         fontWeight: 300
         *       }
         *     }
         *
         * These sprite attribute overrides will apply to custom sprites of all charts
         * specified using the {@link Ext.draw.Container#sprites} config.
         * The overrides are specified by sprite type, e.g. sprites.text config
         * tells to apply given attributes to all {@link Ext.draw.sprite.Text text} sprites.
         */
        sprites: {
            text: {
                fontSize: &#39;default&#39;,
                fontWeight: &#39;default&#39;,
                fontFamily: &#39;default&#39;,
                fillStyle: &#39;black&#39;
            }
        },

<span id='Ext-chart-theme-Base-cfg-legend'>        /**
</span>         * Style information for the {Ext.chart.legend.SpriteLegend sprite legend}.
         * If the {@link Ext.chart.legend.Legend DOM} legend is used, this config is ignored.
         * For additional details see {@link Ext.chart.AbstractChart#legend}.
         * @cfg {Object} legend
         * @cfg {Ext.chart.legend.sprite.Item} legend.item
         * @cfg {Object} legend.border See {@link Ext.chart.legend.SpriteLegend#border}.
         */
        legend: {
            label: {
                fontSize: 14,
                fontWeight: &#39;default&#39;,
                fontFamily: &#39;default&#39;,
                fillStyle: &#39;black&#39;
            },
            border: {
                lineWidth: 1,
                radius: 4,
                fillStyle: &#39;none&#39;,
                strokeStyle: &#39;gray&#39;
            },
            background: &#39;white&#39;
        },

<span id='Ext-chart-theme-Base-cfg-seriesThemes'>        /**
</span>         * @private
         * An object with the following structure:
         * {
         *   fillStyle: [color, color, ...],
         *   strokeStyle: [color, color, ...],
         *   ...
         * }
         * If missing, generated from the other configs: &#39;baseColor, &#39;gradients&#39;, &#39;colors&#39;.
         */
        seriesThemes: undefined,

<span id='Ext-chart-theme-Base-cfg-markerThemes'>        markerThemes: {
</span>            type: [&#39;circle&#39;, &#39;cross&#39;, &#39;plus&#39;, &#39;square&#39;, &#39;triangle&#39;, &#39;diamond&#39;]
        },

<span id='Ext-chart-theme-Base-cfg-useGradients'>        /**
</span>         * @deprecated 5.0.1 Use the {@link Ext.draw.Container#gradients} config instead.
         */
        useGradients: false,

<span id='Ext-chart-theme-Base-cfg-background'>        /**
</span>         * @deprecated 5.0.1 Use the {@link Ext.chart.AbstractChart#background} config instead.
         */
        background: null
    },

<span id='Ext-chart-theme-Base-property-colorDefaults'>    colorDefaults: [
</span>        &#39;#94ae0a&#39;,
        &#39;#115fa6&#39;,
        &#39;#a61120&#39;,
        &#39;#ff8809&#39;,
        &#39;#ffd13e&#39;,
        &#39;#a61187&#39;,
        &#39;#24ad9a&#39;,
        &#39;#7c7474&#39;,
        &#39;#a66111&#39;
    ],

<span id='Ext-chart-theme-Base-method-constructor'>    constructor: function (config) {
</span>        this.initConfig(config);
        this.resolveDefaults();
    },

<span id='Ext-chart-theme-Base-property-defaultRegEx'>    defaultRegEx: /^default([+\-/\*]\d+(?:\.\d+)?)?$/,
</span>
<span id='Ext-chart-theme-Base-property-defaultOperators'>    defaultOperators: {
</span>        &#39;*&#39;: function (v1, v2) {
            return v1 * v2;
        },
        &#39;+&#39;: function (v1, v2) {
            return v1 + v2;
        },
        &#39;-&#39;: function (v1, v2) {
            return v1 - v2;
        }
    },

<span id='Ext-chart-theme-Base-method-resolveChartDefaults'>    resolveChartDefaults: function () {
</span>        var chart = Ext.clone(this.getChart()),
            chartType, captionName,
            chartConfig, captionConfig;

        for (chartType in chart) {
            chartConfig = chart[chartType];
            if (&#39;captions&#39; in chartConfig) {
                for (captionName in chartConfig.captions) {
                    captionConfig = chartConfig.captions[captionName];
                    if (captionConfig) {
                        this.replaceDefaults(captionConfig.style);
                    }
                }
            }
        }
        this.setChart(chart);
    },

<span id='Ext-chart-theme-Base-method-resolveDefaults'>    resolveDefaults: function () {
</span>        var me = this;

        Ext.onInternalReady(function () {
            var sprites = Ext.clone(me.getSprites()),
                legend = Ext.clone(me.getLegend()),
                axis = Ext.clone(me.getAxis()),
                series = Ext.clone(me.getSeries()),
                div, key, config;

            if (!me.superclass.defaults) {
                div = Ext.getBody().createChild({
                    tag: &#39;div&#39;,
                    cls: me.defaultsDivCls
                });
                me.superclass.defaults = {
                    fontFamily: div.getStyle(&#39;fontFamily&#39;),
                    fontWeight: div.getStyle(&#39;fontWeight&#39;),
                    fontSize: parseFloat(div.getStyle(&#39;fontSize&#39;)),
                    fontVariant: div.getStyle(&#39;fontVariant&#39;),
                    fontStyle: div.getStyle(&#39;fontStyle&#39;)
                };
                div.destroy();
            }

            me.resolveChartDefaults();

            me.replaceDefaults(sprites.text);
            me.setSprites(sprites);

            me.replaceDefaults(legend.label);
            me.setLegend(legend);

            for (key in axis) {
                config = axis[key];
                me.replaceDefaults(config.label);
                me.replaceDefaults(config.title);
            }
            me.setAxis(axis);

            for (key in series) {
                config = series[key];
                me.replaceDefaults(config.label);
            }
            me.setSeries(series);
        });
    },

<span id='Ext-chart-theme-Base-method-replaceDefaults'>    replaceDefaults: function (target) {
</span>        var me = this,
            defaults = me.superclass.defaults,
            defaultRegEx = me.defaultRegEx,
            key, value, match, binaryFn;

        if (Ext.isObject(target)) {
            for (key in defaults) {
                match = defaultRegEx.exec(target[key]);
                if (match) {
                    value = defaults[key];
                    match = match[1];
                    if (match) {
                        binaryFn = me.defaultOperators[match.charAt(0)];
                        value = Math.round(binaryFn(value, parseFloat(match.substr(1))));
                    }
                    target[key] = value;
                }
            }
        }
    },

<span id='Ext-chart-theme-Base-method-applyBaseColor'>    applyBaseColor: function (baseColor) {
</span>        var midColor, midL;
        if (baseColor) {
            midColor = baseColor.isColor ? baseColor : Ext.util.Color.fromString(baseColor);
            midL = midColor.getHSL()[2];
            if (midL &lt; 0.15) {
                midColor = midColor.createLighter(0.3);
            } else if (midL &lt; 0.3) {
                midColor = midColor.createLighter(0.15);
            } else if (midL &gt; 0.85) {
                midColor = midColor.createDarker(0.3);
            } else if (midL &gt; 0.7) {
                midColor = midColor.createDarker(0.15);
            }
            this.setColors([
                midColor.createDarker(0.3).toString(),
                midColor.createDarker(0.15).toString(),
                midColor.toString(),
                midColor.createLighter(0.12).toString(),
                midColor.createLighter(0.24).toString(),
                midColor.createLighter(0.31).toString()
            ]);
        }
        return baseColor;
    },

<span id='Ext-chart-theme-Base-method-applyColors'>    applyColors: function (newColors) {
</span>        return newColors || this.colorDefaults;
    },

<span id='Ext-chart-theme-Base-method-updateUseGradients'>    updateUseGradients: function (useGradients) {
</span>        if (useGradients) {
            this.updateGradients({
                type: &#39;linear&#39;,
                degrees: 90
            });
        }
    },

<span id='Ext-chart-theme-Base-method-updateBackground'>    updateBackground: function (background) {
</span>        if (background) {
            var chart = this.getChart();
            chart.defaults.background = background;
            this.setChart(chart);
        }
    },

<span id='Ext-chart-theme-Base-method-updateGradients'>    updateGradients: function (gradients) {
</span>        var colors = this.getColors(),
            items = [], gradient,
            midColor, color,
            i, ln;

        if (Ext.isObject(gradients)) {
            for (i = 0, ln = colors &amp;&amp; colors.length || 0; i &lt; ln; i++) {
                midColor = Ext.util.Color.fromString(colors[i]);
                if (midColor) {
                    color = midColor.createLighter(0.15).toString();
                    gradient = Ext.apply(Ext.Object.chain(gradients), {
                        stops: [
                            {
                                offset: 1,
                                color: midColor.toString()
                            },
                            {
                                offset: 0,
                                color: color.toString()
                            }
                        ]
                    });
                    items.push(gradient);
                }
            }
            this.setColors(items);
        }
    },

<span id='Ext-chart-theme-Base-method-applySeriesThemes'>    applySeriesThemes: function (newSeriesThemes) {
</span>        // Init the &#39;colors&#39; config with solid colors generated from the &#39;baseColor&#39;.
        this.getBaseColor();
        // Init the &#39;gradients&#39; config with a hardcoded value, if the legacy &#39;useGradients&#39;
        // config was set to &#39;true&#39;. This in turn updates the &#39;colors&#39; config.
        this.getUseGradients();
        // Init the &#39;gradients&#39; config normally. This also updates the &#39;colors&#39; config.
        this.getGradients();
        var colors = this.getColors(); // Final colors.
        if (!newSeriesThemes) {
            newSeriesThemes = {
                fillStyle: Ext.Array.clone(colors),
                strokeStyle: Ext.Array.map(colors, function (value) {
                    var color = Ext.util.Color.fromString(value.stops ? value.stops[0].color : value);
                    return color.createDarker(0.15).toString();
                })
            };
        }
        return newSeriesThemes;
    }

});
</pre>
</body>
</html>
